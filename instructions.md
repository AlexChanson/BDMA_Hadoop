# Projet Hadoop/Web

This document contains instruction to run our map reduce jobs and the REST API that goes with it.

## Prerequisites
The version control system Git must be installed on the system, if not run:  
``sudo apt install git``  
The project build system Maven must be installed on the system, if not run:  
``sudo apt install maven``

## Downloading the JAR
The build process might be slow especially on the virtual machine, if you do not wish to build the two JAR files required to run our project you can simply download the latest versions here:  
[Map Reduce jobs]()  
[REST API]()  
You can skip "Building" steps.  
We also provide an API endpoint at home.alexc.ovh port 80.
## Building the MapReduce Jobs
The first step if not downloading the jar files is to build the Map Reduce jobs, this is done fully automatically using the Maven build system.  
First setup the project using git:  
`git clone https://github.com/xairon/MapReduce_jobs`  
The move to the directory  
`cd MapReduce_jobs`  
Finally run maven to assemble the jar  
`mvn package`
## Running the MapReduce Jobs
Once built the MapReduce jobs can now be run, this is done using the following command:  
```java -cp path/to/jar:`hbase classpath` mapreduce.Main```
## Building the API
First setup the project directory run:  
``git clone https://github.com/AlexChanson/BDMA_Hadoop``  
Then go to the directory:  
``cd BDMA_Hadoop``  
Now you need to build the jar, this is simple as maven does everything with one simple command:  
``mvn package``  

This last step may take a few minutes as maven needs to download all need dependencies.
Wait until the build success message appears:  
<pre>[<font color="#5C5CFF"><b>INFO</b></font>] <b>------------------------------------------------------------------------</b>
[<font color="#5C5CFF"><b>INFO</b></font>] <font color="#00FF00"><b>BUILD SUCCESS</b></font>
[<font color="#5C5CFF"><b>INFO</b></font>] <b>------------------------------------------------------------------------</b>
</pre>

## Running the API
Maven has placed the compiled jar in the subdirectory `target` subdirectory, it can be run using:  
`java -jar target/hadoop-0.1.0.jar`  
This will start the embedded Tomcat server on port _8090_

## Testing the API
To test the API it is recommended to ruse the popular command line utility _curl_

### Question 1
Running `curl http://localhost:8090/Aiwsbu/v1/students/2001000814/transcripts/L1` on our server yields the following result:  
```json
{"Email":"","Program":"3","Second":[{"Grade":7.31,"Code":"S01A006","Name":"Unknown"},{"Grade":14.45,"Code":"S02A005","Name":"Unknown"},{"Grade":9.68,"Code":"S02B026","Name":"Unknown"},{"Grade":5.52,"Code":"S03A006","Name":"Unknown"},{"Grade":15.6,"Code":"S04A007","Name":"Unknown"},{"Grade":16.66,"Code":"S04B039","Name":"Djgebtl"},{"Grade":0.03,"Code":"S05A005","Name":"Unknown"},{"Grade":3.21,"Code":"S05A010","Name":"Unknown"},{"Grade":11.59,"Code":"S07A001","Name":"Unknown"},{"Grade":17.91,"Code":"S07A003","Name":"Unknown"},{"Grade":6.81,"Code":"S07B005","Name":"Ays Tinbukyhvtmp"},{"Grade":12.04,"Code":"S07B023","Name":"Unknown"},{"Grade":9.77,"Code":"S07B039","Name":"Unknown"},{"Grade":5.93,"Code":"S07B046","Name":"Unknown"},{"Grade":4.9,"Code":"S08B009","Name":"Unknown"},{"Grade":1.34,"Code":"S09A007","Name":"Unknown"},{"Grade":5.99,"Code":"S09B025","Name":"Unknown"},{"Grade":1.54,"Code":"S10B025","Name":"Unknown"}],"First":[{"Grade":19.89,"Code":"S01A005","Name":"Unknown"},{"Grade":9.64,"Code":"S01B039","Name":"Unknown"},{"Grade":9.43,"Code":"S02B033","Name":"Unknown"},{"Grade":11.97,"Code":"S03A006","Name":"Unknown"},{"Grade":13.52,"Code":"S03A008","Name":"Ywdji Okwufjkvieye Rrrcpffklj"},{"Grade":9.73,"Code":"S03B029","Name":"Unknown"},{"Grade":10.92,"Code":"S04A001","Name":"Unknown"},{"Grade":12.22,"Code":"S04B003","Name":"Unknown"},{"Grade":15.9,"Code":"S04B024","Name":"Unknown"},{"Grade":14.49,"Code":"S04B031","Name":"Unknown"},{"Grade":3.76,"Code":"S05B020","Name":"Unknown"},{"Grade":19.53,"Code":"S05B043","Name":"Unknown"},{"Grade":13.05,"Code":"S07A004","Name":"Unknown"},{"Grade":7.49,"Code":"S07A005","Name":"Unknown"},{"Grade":14.93,"Code":"S07A009","Name":"Unknown"},{"Grade":17.69,"Code":"S08A005","Name":"Unknown"},{"Grade":10.74,"Code":"S09A003","Name":"Unknown"},{"Grade":1.53,"Code":"S09B020","Name":"Ko Pfxasolmmnq"},{"Grade":2.18,"Code":"S09B032","Name":"Unknown"},{"Grade":19.85,"Code":"S10A004","Name":"Unknown"}],"Name":"Okhbvpghwfypu Nic"}
```
### Question 2
Running `curl http://localhost:8090/Aiwsbu/v1/rates/01` on our server yields the following results:  
```json
[{"Year":2002,"Rate":0.465},{"Year":2003,"Rate":0.48},{"Year":2004,"Rate":0.496},{"Year":2005,"Rate":0.514},{"Year":2006,"Rate":0.521},{"Year":2007,"Rate":0.505},{"Year":2008,"Rate":0.461},{"Year":2009,"Rate":0.495},{"Year":2010,"Rate":0.475},{"Year":2011,"Rate":0.497},{"Year":2012,"Rate":0.511},{"Year":2013,"Rate":0.479},{"Year":2014,"Rate":0.489},{"Year":2015,"Rate":0.487},{"Year":2016,"Rate":0.492},{"Year":2017,"Rate":0.503},{"Year":2018,"Rate":0.508},{"Year":2019,"Rate":0.491}]
```
### Question 3
Running `curl http://localhost:8090/Aiwsbu/v1/courses/S01A006/rates` on our server yields the following results:  
```json
[{"Rate":0.52,"Name":"Mgcock P Wwisiegvoqjsu"}]
```
### Question 4
Running `curl http://localhost:8090/Aiwsbu/v1/courses/S10A009/rates/2017` on our server yields the following results:  
```json
{"Rate":0.5263157894736842,"Name":"Ij Ttmplmxuf"}
```
### Question 5
Running `curl http://localhost:8090/Aiwsbu/v1/programs/M2/means/2025` on our server yields the following results:  
```json
{"S07B031":{"Grade":10.669473684210525,"Name":"Uogguqev Ilrrxh"},"S07B036":{"Grade":11.688888888888888,"Name":"Jhkhv Trrwlmok"},"S07B035":{"Grade":10.955714285714288,"Name":"Wgaok Ielexhwxwg Focy"},"S07B034":{"Grade":10.003333333333332,"Name":"Hp Pgtedxwwmgoasq Voyjixtmc"},
```
...
```json
"S05B015":{"Grade":10.09076923076923,"Name":"Mtxvfjmr"},"S05B014":{"Grade":11.67,"Name":"Xywd Xccfcudhpyhj Gsdltwqfvh"},"S05B013":{"Grade":12.441666666666668,"Name":"Y Nbjwhksnam"}}
```
Too long to include in whole.
### Question 6
Running `curl http://localhost:8090/Aiwsbu/v1/instructors/Wplkferdafm%20Ioxxyptljdl/rates` on our server yields the following results:  
Note the `%20` MUST be used instead of the space in teacher's names following URL encoding standards.
```json
{"S01B020/2005":{"Rate":0.6,"Name":"Homx Sooxslki"},"S04B026/2008":{"Rate":0.5625,"Name":"Ixohhikpnvow A"},"S09B014/2008":{"Rate":0.49523809523809526,"Name":"Urgkvqmgqwxj Gjtvpl Wvwvgid Oo"},"S05B025/2011":{"Rate":0.5698324022346368,"Name":"Luutsvu Qtblpgicnfjc Pagnyqixengyqe"},
```
...
```json
"S06B029/2016":{"Rate":0.46715328467153283,"Name":"Qpnhilhbdkx"},"S08B030/2010":{"Rate":0.5043478260869565,"Name":"Xhbgqasccjha"}}
```
Too long to include in whole.
### Question 7
Running `curl http://localhost:8090/Aiwsbu/v1/ranks/L3/years/2007` on our server yields the following results:  
```json
{"2004000933":12.570270270270273,"2006000230":12.446666666666665,"2004000466":12.42472222222222,"2004000050":12.295945945945947,"2004000085":12.184871794871798,"2006000707":12.174358974358972,"2006000836":12.170000000000002,"2006000052":11.9745,"2006000431":11.834102564102563,"2004000235":11.78375,"2006000323":11.768205128205127,"2006000350":11.748157894736844,"2004000163":11.711621621621617,"2006000007":11.700526315789476,"2006000195":11.67675675675676,"2006000885":11.634102564102568,"2006000526":11.518974358974358,"2006000347":11.498974358974358,"2004000587":11.49325,"2004000826":11.474054054054053,"2006000304":11.462564102564105,"2006000317":11.401052631578946,"2004000869":11.384473684210528,"2006000227":11.368500000000003,"2006000157":11.353333333333332,"2004000419":11.34763157894737,"2006000287":11.333333333333336,"2006000510":11.332750000000003,"2004000877":11.331500000000002,"2006000459":11.32405405405405,"2004000090":11.319473684210529,"2006000184":11.30324324324324,"2006000425":11.271666666666668,"2004000098":11.27153846153846,"2006000827":11.262051282051283,"2004000673":11.2495,"2004000993":11.229999999999999,"2004000434":11.222999999999997,"2006000603":11.216153846153844,"2004000041":11.197894736842107,"2004000292":11.191500000000001,"2004000228":11.180277777777782,"2004000464":11.169210526315789,"2006000726":11.16871794871795,"2006000734":11.160769230769231,"2006000049":11.14846153846154,"2004000876":11.140769230769232,"2006000071":11.13846153846154,"2004000305":11.128684210526318,"2004000691":11.126111111111111,"2004000552":11.114210526315787,"2004000459":11.113500000000004,"2006000817":11.110263157894735,"2004000627":11.105263157894736,"2004000988":11.094054054054055,"2006000421":11.091351351351353,"2006000770":11.082564102564103,"2004000221":11.078684210526317,"2004000889":11.071842105263158,"2006000963":11.028974358974358,"2004000274":10.999487179487183,"2006000955":10.997297297297301,"2004000043":10.987894736842106,"2006000619":10.978421052631576,"2006000585":10.976578947368422,"2004000474":10.973157894736842,"2004000920":10.96153846153846,"2006000390":10.957368421052632,"2006000895":10.95657894736842,"2006000952":10.954102564102564,"2006000123":10.944210526315791,"2006000012":10.943243243243243,"2004000983":10.94081081081081,"2006000699":10.93263157894737,"2004000758":10.929999999999998,"2006000754":10.90351351351351,"2004000895":10.9,"2004000505":10.89923076923077,"2004000862":10.898205128205129,"2006000907":10.894864864864864,"2004000184":10.882820512820512,"2004000616":10.881842105263162,"2004000894":10.87763157894737,"2006000575":10.871500000000001,"2006000449":10.863846153846156,"2006000048":10.859499999999999,"2004000642":10.854722222222222,"2004000103":10.84921052631579,"2004000053":10.847428571428573,"2006000961":10.843947368421052,"2006000554":10.835526315789474,"2006000370":10.82837837837838,"2004000653":10.819487179487181,"2006000167":10.816052631578946,"2004000776":10.797368421052632,"2004000825":10.795789473684213,"2004000521":10.785945945945947,"2004000606":10.785128205128204,"2006000429":10.784473684210527,"2006000927":10.765789473684212,"2006000276":10.75027027027027,"2006000252":10.746578947368416,"2004000203":10.735263157894735,"2006000598":10.733421052631575,"2006000574":10.72789473684211,"2006000454":10.723611111111113,"2006000600":10.721891891891893,"2004000312":10.71975,"2006000791":10.713589743589745,"2006000561":10.712000000000003,"2004000513":10.700769230769234,"2006000924":10.689487179487182,"2006000142":10.686315789473687,"2006000567":10.678108108108109,"2006000715":10.677692307692308,"2004000948":10.672051282051282,"2006000632":10.67025,"2004000586":10.669743589743588,"2006000450":10.648157894736844,"2006000233":10.645641025641023,"2006000172":10.6445,"2006000813":10.642499999999998,"2006000314":10.636486486486486,"2006000568":10.633750000000004,"2006000988":10.631621621621623,"2006000394":10.631538461538462,"2004000901":10.628205128205131,"2004000559":10.620263157894739,"2006000239":10.617692307692309,"2004000002":10.595135135135132,"2006000616":10.58605263157895,"2006000185":10.57871794871795,"2004000010":10.57405405405405,"2004000605":10.567,"2006000694":10.55871794871795,"2004000125":10.553333333333336,"2006000972":10.55125,"2006000251":10.55076923076923,"2006000310":10.55025641025641,"2004000908":10.548918918918918,"2004000100":10.547368421052632,"2004000137":10.546153846153844,"2004000538":10.517142857142858,"2006000849":10.516315789473683,"2006000005":10.513499999999997,"2004000038":10.511282051282052,"2006000091":10.509736842105264,"2004000039":10.50973684210526,"2004000905":10.496249999999996,"2006000183":10.493421052631579,"2006000155":10.483947368421054,"2004000502":10.483589743589743,"2006000608":10.482631578947371,"2004000113":10.479487179487181,"2006000664":10.477249999999998,"2006000468":10.476578947368422,"2006000366":10.473947368421053,"2004000323":10.459230769230766,"2004000845":10.450499999999996,"2006000134":10.441750000000003,"2004000001":10.4395,"2004000986":10.43948717948718,"2006000200":10.426842105263159,"2004000144":10.425263157894735,"2004000519":10.417948717948718,"2004000307":10.40923076923077,"2006000099":10.405526315789475,"2004000999":10.3965,"2006000951":10.392820512820512,"2006000159":10.391578947368423,"2004000218":10.387027027027028,"2006000787":10.386052631578947,"2004000239":10.367179487179488,"2006000308":10.354102564102563,"2006000521":10.340769230769231,"2004000821":10.338918918918921,"2006000910":10.335128205128203,"2004000462":10.331282051282049,"2006000797":10.322999999999997,"2004000008":10.3225,"2004000326":10.31948717948718,"2004000942":10.31641025641026,"2006000255":10.313157894736845,"2004000133":10.292564102564103,"2004000715":10.286153846153846,"2004000405":10.282368421052633,"2006000558":10.269743589743594,"2006000899":10.263513513513512,"2004000308":10.251025641025638,"2006000176":10.234736842105265,"2006000497":10.231621621621622,"2004000646":10.22974358974359,"2004000491":10.224871794871792,"2004000092":10.221052631578946,"2004000257":10.220833333333331,"2004000146":10.215675675675676,"2004000516":10.214736842105266,"2004000222":10.21128205128205,"2004000771":10.20625,"2006000669":10.20575,"2004000756":10.20421052631579,"2006000079":10.203999999999995,"2004000418":10.193783783783784,"2004000917":10.193333333333332,"2004000360":10.192105263157895,"2004000486":10.190263157894734,"2006000489":10.185789473684212,"2004000938":10.182368421052631,"2006000101":10.177179487179489,"2004000569":10.176410256410257,"2006000749":10.1725,"2004000517":10.16875,"2004000174":10.166052631578948,"2006000701":10.16157894736842,"2006000168":10.155384615384614,"2004000445":10.14666666666667,"2006000242":10.144864864864866,"2006000636":10.131538461538463,"2006000798":10.121315789473684,"2006000714":10.121315789473684,"2006000126":10.113499999999998,"2004000887":10.103250000000001,"2006000051":10.101025641025638,"2004000893":10.091081081081082,"2004000209":10.08589743589744,"2006000061":10.085135135135133,"2006000544":10.084210526315786,"2006000543":10.083589743589743,"2004000424":10.080000000000004,"2006000249":10.06394736842105,"2004000753":10.063684210526318,"2004000595":10.062051282051282,"2006000385":10.054871794871792,"2006000755":10.054054054054054,"2006000305":10.04756756756757,"2004000479":10.046315789473685,"2006000842":10.038947368421054,"2004000310":10.03105263157895,"2006000730":10.014871794871793,"2004000219":10.011111111111113,"2006000852":9.998205128205129,"2004000426":9.988947368421051,"2004000195":9.98692307692308,"2004000458":9.986499999999998,"2004000647":9.9825,"2004000609":9.980000000000004,"2004000571":9.977435897435901,"2004000550":9.973157894736843,"2006000563":9.972564102564103,"2004000004":9.96871794871795,"2004000787":9.96179487179487,"2006000661":9.958285714285717,"2006000357":9.955250000000003,"2006000064":9.954500000000001,"2006000932":9.953947368421053,"2006000806":9.95054054054054,"2004000717":9.946756756756756,"2004000315":9.946410256410257,"2006000306":9.94555555555556,"2006000130":9.945263157894738,"2004000899":9.941999999999998,"2004000207":9.941282051282052,"2004000543":9.934102564102563,"2004000156":9.921025641025645,"2004000005":9.920500000000002,"2004000848":9.91657894736842,"2006000466":9.912105263157898,"2004000739":9.909487179487181,"2004000063":9.904473684210526,"2004000693":9.901944444444446,"2004000046":9.891282051282047,"2006000691":9.882894736842104,"2004000514":9.881052631578951,"2006000591":9.87825,"2004000779":9.87825,"2004000683":9.866216216216216,"2006000009":9.864999999999998,"2004000072":9.863076923076921,"2004000044":9.86,"2004000262":9.857948717948718,"2004000127":9.852051282051283,"2006000404":9.84974358974359,"2006000712":9.843749999999998,"2004000440":9.834358974358972,"2006000105":9.830769230769231,"2004000416":9.822750000000001,"2004000523":9.81125,"2006000685":9.806578947368418,"2006000611":9.804324324324323,"2006000880":9.802820512820514,"2006000460":9.80025641025641,"2004000078":9.79225,"2006000058":9.789473684210526,"2004000734":9.78871794871795,"2006000376":9.77153846153846,"2004000562":9.76857142857143,"2004000018":9.764358974358974,"2006000507":9.763684210526314,"2004000671":9.759487179487182,"2006000402":9.753589743589743,"2006000335":9.74842105263158,"2006000352":9.737500000000002,"2004000186":9.7305,"2006000579":9.729210526315791,"2006000888":9.727222222222222,"2004000801":9.725000000000001,"2006000439":9.720526315789474,"2004000173":9.720499999999998,"2006000512":9.71236842105263,"2004000809":9.702051282051281,"2006000238":9.698205128205128,"2006000976":9.697105263157896,"2004000304":9.697,"2004000499":9.695999999999998,"2004000522":9.695526315789472,"2004000768":9.695128205128205,"2004000461":9.694102564102565,"2006000662":9.693333333333333,"2004000399":9.668000000000001,"2006000035":9.665000000000001,"2004000722":9.658749999999998,"2006000580":9.658205128205127,"2004000149":9.656923076923075,"2004000775":9.653846153846155,"2004000945":9.651315789473683,"2004000141":9.65076923076923,"2006000531":9.641621621621622,"2006000879":9.6375,"2006000993":9.634615384615387,"2006000281":9.629736842105268,"2006000380":9.624358974358977,"2006000621":9.619,"2004000656":9.618157894736845,"2004000115":9.615526315789475,"2004000109":9.601315789473684,"2004000082":9.598947368421053,"2006000279":9.598918918918924,"2004000079":9.596315789473682,"2006000986":9.594736842105261,"2004000754":9.593846153846156,"2006000270":9.592750000000002,"2006000319":9.588684210526315,"2004000863":9.578947368421051,"2006000882":9.578499999999998,"2004000229":9.5765,"2004000720":9.574473684210528,"2004000718":9.5735,"2006000803":9.56825,"2004000384":9.565249999999999,"2004000159":9.557749999999999,"2006000995":9.553421052631577,"2006000935":9.553076923076924,"2006000782":9.54871794871795,"2004000498":9.54175,"2006000256":9.533684210526317,"2004000052":9.529250000000001,"2006000010":9.523611111111116,"2006000379":9.518000000000002,"2004000847":9.514736842105265,"2004000064":9.493846153846155,"2006000525":9.486052631578948,"2004000931":9.478717948717948,"2006000076":9.468461538461538,"2004000687":9.455999999999998,"2004000264":9.43,"2004000247":9.418378378378378,"2004000198":9.41,"2006000985":9.40026315789474,"2004000967":9.39552631578947,"2006000823":9.392564102564105,"2006000837":9.39205128205128,"2004000202":9.383846153846154,"2006000193":9.37825,"2006000085":9.375128205128208,"2006001000":9.36794871794872,"2006000438":9.366153846153846,"2006000639":9.364871794871794,"2006000593":9.36473684210526,"2004000855":9.361081081081084,"2006000974":9.359230769230768,"2006000474":9.350000000000003,"2004000960":9.325897435897435,"2004000500":9.324250000000001,"2004000921":9.32153846153846,"2006000295":9.318974358974359,"2004000560":9.309499999999996,"2004000740":9.303157894736843,"2006000006":9.303076923076924,"2006000303":9.288684210526316,"2006000783":9.283684210526317,"2004000289":9.281315789473684,"2006000814":9.272749999999998,"2004000976":9.2685,"2004000230":9.25277777777778,"2004000769":9.248974358974355,"2006000923":9.235384615384616,"2006000198":9.227948717948717,"2004000730":9.22157894736842,"2004000969":9.217368421052631,"2006000804":9.212051282051284,"2004000575":9.192499999999995,"2006000516":9.192250000000001,"2004000584":9.185405405405408,"2006000762":9.155526315789476,"2004000015":9.153846153846152,"2006000954":9.134871794871795,"2006000898":9.092500000000001,"2006000693":9.089736842105268,"2004000368":9.08225,"2006000530":9.080256410256412,"2006000473":9.07157894736842,"2006000132":9.062750000000001,"2006000290":9.04717948717949,"2006000939":9.046315789473681,"2006000901":9.04578947368421,"2004000780":9.040263157894735,"2006000030":9.025384615384613,"2006000122":9.02076923076923,"2004000341":9.016923076923076,"2006000455":9.015499999999998,"2006000844":9.00846153846154,"2004000278":9.005,"2004000456":9.003076923076927,"2006000877":8.961282051282053,"2006000312":8.96102564102564,"2004000255":8.928648648648647,"2006000349":8.922820512820516,"2004000111":8.892631578947368,"2004000674":8.85925,"2004000457":8.834500000000002,"2006000891":8.8325,"2004000284":8.832307692307692,"2006000495":8.829749999999999,"2006000957":8.821315789473681,"2006000333":8.811,"2004000080":8.805526315789475,"2004000003":8.80425,"2004000924":8.801282051282053,"2006000414":8.795128205128204,"2006000127":8.76625,"2004000926":8.73157894736842,"2004000075":8.721250000000001,"2004000501":8.714736842105266,"2006000392":8.69525,"2004000396":8.686,"2004000746":8.683076923076925,"2006000634":8.683,"2006000326":8.652564102564103,"2006000146":8.636923076923077,"2004000818":8.6265,"2006000599":8.610555555555557,"2006000053":8.596410256410257,"2004000916":8.574444444444442,"2006000307":8.571052631578947,"2006000224":8.564358974358973,"2006000584":8.5515,"2004000211":8.548108108108108,"2006000066":8.522105263157899,"2004000244":8.520750000000003,"2004000677":8.514102564102563,"2004000036":8.483333333333333,"2004000906":8.463846153846154,"2004000420":8.457297297297297,"2004000318":8.438421052631577,"2004000147":8.398684210526316,"2004000602":8.376499999999998,"2004000430":8.313,"2006000556":8.288947368421054,"2006000502":8.27825,"2006000779":8.246944444444445,"2006000044":8.240512820512821,"2004000702":8.187692307692311,"2004000996":8.05315789473684,"2004000214":8.0295,"2006000646":7.9956410256410235,"2006000905":7.975750000000001,"2004000624":7.786153846153845,"2004000782":7.6957894736842105,"2006000013":7.6720588235294125,"2006000342":7.6572499999999994,"2006000962":7.649999999999999,"2006000115":7.201842105263158}
```

### Note on errors
The server will serve the HTTP codes 404 and 500 for wrong id lookup and internal error, we took liberty to include custom error messages in addition to the HTTP error. This seems to be a common practice in public APIs ([example](https://developer.spotify.com/documentation/web-api/))